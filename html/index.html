<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
</head>
<body class="body">
    <!-- <form method="post" enctype="multipart/form-data" action="http://localhost:5000/img/upload">
        <input type="file" accept=".png,.jpg" name="file">
        <button>Upload PNG or JPG up to 10 MB</button>
    </form> -->
    <img src="http://localhost:5000/img/44158.png" alt="">
    <header>
        <div class="pointer header_btn">
            <img src="./icons/male-icon.svg" alt="" class="header_icon">
            <h5 class="header_btn_text">User</h5>
        </div>
        <div class="pointer header_btn">
            <img src="./icons/pencil-icon.svg" alt="" class="header_icon">
            <h5 class="header_btn_text">My lists</h5>
        </div>
        <div class="pointer header_btn">
            <img src="./icons/door-check-out-icon.svg" alt="" class="header_icon">
            <h5 class="header_btn_text">Sign in</h5>
        </div>
    </header>
    <div class="middle_title">
        <h3>TIERLIST</h3>
    </div>
    <div class="admin_menu">
        <div class="admin_menu_title">
            <h3>ADMIN MENU</h3>
        </div>
        <div class="pointer admin_menu_item">
            <img src="./icons/plus-icon.svg" alt="">
            <h5>New Template</h5>
        </div>
        <div class="pointer admin_menu_item">
            <img src="./icons/male-icon.svg" alt="">
            <h5>Users</h5>
        </div>
    </div>
    <div class="main">
        <div class="basic_list">
            <h3>Templates</h3>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
        </div>
        <div class="basic_list">
            <h3>User lists</h3>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
            <div class="pointer list_item">
                <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="" class="list_item_img">
                <h5 class="list_item_title">Test Item</h5>
            </div>
        </div>
    </div>
    <div class="main">
        <div class="template_action">
            <h3>Template Title</h3>
            <div class="pointer template_btn">
                <img src="./icons/close-square-icon.svg" alt="">
                <h5>Delete</h5>
            </div>
            <div class="pointer template_btn">
                <img src="./icons/plus-icon.svg" alt="">
                <h5>Title Image</h5>
            </div>
            <div class="pointer template_btn">
                <img src="./icons/pencil-icon.svg" alt="">
                <h5>Save</h5>
            </div>
        </div>
        <div class="template_board">
            <h3>Tiers</h3>
            <div class="template_board_tiers">
                <h5 class="drag">Best</h5>
                <h5 class="drag">Good</h5>
                <h5 class="drag">Average</h5>
                <h5 class="drag">Bad</h5>
                <h5 class="drag">Worst</h5>
                <h5 class="drag">Best</h5>
                <h5 class="drag">Good</h5>
                <h5 class="drag">Average</h5>
                <h5 class="drag">Bad</h5>
                <h5 class="drag">Worst</h5>
                <h5 class="drag">Best</h5>
                <h5 class="drag">Good</h5>
                <h5 class="drag">Average</h5>
                <h5 class="drag">Bad</h5>
                <h5 class="drag">Worst</h5>
            </div>
            <img class="tier_plus_icon pointer" src="./icons/plus-icon.svg" alt="">
            <h3>Images</h3>
            <div class="template_board_images" ondrop="">
                <div class="pointer board_img">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                </div>
                <div class="pointer board_img">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                </div>
                <div class="pointer board_img">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                </div>
                <div class="pointer board_img">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                </div>
                <div class="pointer board_img">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                </div>
            </div>
            <img class="tier_plus_icon pointer" src="./icons/plus-icon.svg" alt="">
        </div>
    </div>
    <div class="main">
        <div class="tierlist_from_temp">
            <div class="tierlist_action">
                <h3>Template Title</h3>
                <div class="pointer template_btn">
                    <img src="./icons/close-square-icon.svg" alt="">
                    <h5>Delete</h5>
                </div>
                <div class="pointer template_btn">
                    <img src="./icons/pencil-icon.svg" alt="">
                    <h5>Save</h5>
                </div>
            </div>
            <div class="tierlist_board">
                <div class="tier_levels">
                    <div class="tier_level"></div>
                    <div class="tier_level"></div>
                    <div class="tier_level"></div>
                    <div class="tier_level"></div>
                    <div class="tier_level"></div>
                </div>
                <div class="tier_images">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                    <img src="./imgs/c2c9362d-eb52-47ce-a0df-ae58b0e40ae3.png" alt="">
                </div>
            </div>
        </div>
    </div>
    <footer>
        <img src="./icons/alphabet-c-icon.svg" alt="" class="footer_icon">
        <h5 class="footer_text pointer" href="https://www.instagram.com/nikos.kal_/">Designed & Developed By Nikos.kal_</h5>
    </footer>
    <script>

document.getElementsByTagName("body")[0].style.cursor = "url('./icons/pointer-arrow-icon.svg'), auto";

 var clickable = document.getElementsByClassName("pointer");
 var draggable = document.getElementsByClassName("drag");
 
    const body_box = document.getElementsByClassName("body");
    const main_box = document.getElementsByClassName("main");
    const temp_board_tiers_box_box = document.getElementsByClassName("template_board_tiers");
    var main_rect = main_box[1].getBoundingClientRect();//##########TOCHANGELAITER
    var body_rect = body_box[0].getBoundingClientRect();
    var tier_box_rect = temp_board_tiers_box_box[0].getBoundingClientRect();



var green_val = [];
var red_val = [];
var done_j = 0;


////////////////////////////////////////////// BOUNDING BOX UPDATE WITH SCROLL


document.addEventListener("scroll", (event) => {
    lastKnownScrollPosition = window.scrollY;
    // console.log(lastKnownScrollPosition);
    setTimeout(upd_bound(), 100);
    });



////////////////////////////////////////////// COLOR GENERATION

    if ((draggable.length%2)=== 0){
            for(var i = 1; i < ((draggable.length)/2)+1; i++) {
                green_val[i] = 130 * ((1/(draggable.length/2))*i);
            }
            for(var j = (draggable.length/2); j > 0; j--) {
                red_val[j]=130 * ((1/(draggable.length/2))*j);
            }
            
          }else{

            for(var i = 1; i < ((draggable.length)/2)+1; i++) {
                green_val[i] = Math.ceil(130 * ((1/(draggable.length/2))*i));
                console.log(green_val[i]+" I LOOP "+i);
            }
            for(var j = Math.ceil((draggable.length/2)-1); j > 0; j--) {
                red_val[j]=Math.ceil(130 * ((1/(draggable.length/2))*j));
            }
            green_val[i] = 255 / (draggable.length-1);
            red_val[i]=255 / (draggable.length-1);
          }

////////////////////////////////////////////// COLOR ASSIGNMENT TO BACKGROUND OF TIER LEVELS
var boundingclient_arr=[];
var dragging_elm = '';
var top_old='';
var left_old='';
var tier_level_rows=[];
var id_list=[];
for(var i = 0; i < draggable.length; i++) {

    draggable[ i ].style.setProperty("--pseudo-text", `"${i+1}"`);
    
    if(draggable.length%2===0){
        if(i<(draggable.length/2)){
                // console.log(i+"TEST TO CSS LOOP 1 "+Math.round(green_val[(draggable.length/2)-i]));
                draggable[i].style.setProperty("background-color", `rgb(20,${Math.round(green_val[(draggable.length/2)-i])},20)`);
            }else{
                // console.log(i+"TEST TO CSS"+Math.round(Math.round(red_val[i-(green_val.length-2)])));
                draggable[i].style.setProperty("background-color", `rgb(${Math.round(red_val[i-(green_val.length-2)])},20,20)`);
            }
    }else{
        if(i<(draggable.length/2)){
                // console.log(i+" TEST TO CSS LOOP 1 "+green_val[Math.floor(draggable.length/2)-(i-1)]);
                draggable[i].style.setProperty("background-color", `rgb(20,${green_val[Math.floor(draggable.length/2)-(i-1)]},20)`);
            }else{
                // console.log(i+" TEST TO CSS "+red_val[i-(green_val.length-3)]);
                draggable[i].style.setProperty("background-color", `rgb(${red_val[i-(green_val.length-3)]},20,20)`);
            }
    }





/////////////////////////////////////////////DRAG

    boundingclient_arr.push(draggable[i].getBoundingClientRect());

    /////////////////////// TIER LEVEL ROW CALC
    
    if(tier_level_rows.indexOf(boundingclient_arr[i].y)==-1){
        tier_level_rows.push(boundingclient_arr[i].y)
    }

    console.log(tier_level_rows);



    /////////////////////// TIER EVENT LISTENERS


    draggable[i].addEventListener('mousemove', (elm) => {
        document.getElementsByTagName("body")[0].style.cursor = "url('./icons/cursor-hand-icon.svg'), auto";
        if(dragging_elm>=0){
            move(elm.target,dragging_elm);
            dragoveranim(boundingclient_arr,dragging_elm);
            // console.log(boundingclient_arr[dragging_elm]);
            // console.log(dragging_elm);
            // console.log(boundingclient_arr)
        }

    });
    draggable[i].addEventListener('mousedown', (elm) => {
        document.getElementsByTagName("body")[0].style.cursor = "url('./icons/cursor-hand-grab-icon.svg'), auto";
        elm.target.setAttribute("id", "moving");
        elm.target.style.transform='scale(1.2)';
        elm.target.style.zIndex='2';
        for(var i = 0; i < draggable.length; i++) {
            id_list[i] = draggable[i].getAttribute("id");
            // console.log(draggable[i].getAttribute("id"));
        }


        dragging_elm = id_list.findIndex((x) => x === 'moving');
        elm.target.style.marginRight=`-${boundingclient_arr[dragging_elm].width/2}px`;
        upd_bound()

    });
    draggable[i].addEventListener('mouseover', (elm) => {
        document.getElementsByTagName("body")[0].style.cursor = "url('./icons/cursor-hand-icon.svg'), auto";
        elm.target.style.pointerEvents = 'all';


    });
    draggable[i].addEventListener('mouseup', (elm) => {
        document.getElementsByTagName("body")[0].style.cursor = "url('./icons/cursor-hand-icon.svg'), auto";
        elm.target.removeAttribute("id", "moving");
        dragging_elm=null;
        elm.target.style.zIndex='0';
        elm.target.style.transform='scale(1)';
        elm.target.style.pointerEvents = 'stroke';
        draggable = document.getElementsByClassName("drag");

        
    });
    draggable[i].addEventListener('mouseleave', (elm) => {
        document.getElementsByTagName("body")[0].style.cursor = "url('./icons/pointer-arrow-icon.svg'), auto";
    });

    draggable[i].addEventListener("dragstart", function(e) {
        document.getElementsByTagName("body")[0].style.cursor = "url('./icons/cursor-hand-grab-icon.svg'), auto";
        var img = document.createElement("img");
        img.src = "";
        e.dataTransfer.setDragImage(img, 0, 0);
    }, false);
};

function upd_bound(){
    for(var i = 0; i < draggable.length; i++) {
        boundingclient_arr[i] = draggable[i].getBoundingClientRect();
    }
}

function move(element,i) {

    if(document.getElementById('moving')){
        document.getElementsByTagName("body")[0].style.cursor = "url('./icons/cursor-hand-grab-icon.svg'), auto";
        element.style.top = event.clientY - boundingclient_arr[i].y -(boundingclient_arr[i].height/2) +"px";
        element.style.left = event.clientX - boundingclient_arr[i].x - (tier_box_rect.x - main_rect.x) +"px";
    }

}

function dragoveranim(bounding_arr,i){
    // bounding_arr[i] = draggable[i].getBoundingClientRect();
    for(var j = 0; j < draggable.length; j++) {
        if(bounding_arr[j].x>event.clientX - (bounding_arr[i].width/2) && bounding_arr[j]!=bounding_arr[i]){
            if((event.clientY<bounding_arr[j].top+bounding_arr[j].height) && event.clientY>bounding_arr[j].top){
                draggable[j].style.transform="translate(100px,0)";
                draggable[i].style.transform='scale(0.9)';
                console.log(bounding_arr);
            }else{
                draggable[j].style.transform="translate(0,0)";
            }
        }
    }
}
//  ##############################HOVER

 for(var i = 0; i < clickable.length; i++) {
    clickable[i].addEventListener('mouseover', () => {
    document.getElementsByTagName("body")[0].style.cursor = "url('./icons/cursor-hand-icon.svg'), auto";
  });
  clickable[i].addEventListener('mouseleave', () => {
    document.getElementsByTagName("body")[0].style.cursor = "url('./icons/pointer-arrow-icon.svg'), auto";
  });
};


    </script>
</body>
</html>